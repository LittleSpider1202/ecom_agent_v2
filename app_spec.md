# 电商智能运营平台 v2 — 产品规格说明

> 本文档是开发的唯一需求来源。写完后冻结，不在对话中修改，变更须直接编辑本文件并注明版本。

---

## 1. 产品定位

**宏观框架**：公司结构自上而下：市场定位/战略目标 → 业务流程 → 人的组织 → 信息与工具系统。市场是客观约束，业务流程是对市场的响应，人和工具是填充流程的资源。

**目标用户**：中小电商商家。老板一个人扛管理层，执行层链路长、节点多、事件并发，人盯不过来。业务涉及平台、ERP、仓库、快递、供应商等多个系统，数据孤岛严重，跨系统协作全靠人工搬运和对齐。核心诉求：流程清晰、执行到位、成本低。

**产品价值主张**：
人机混合执行流程——机器做确定性工作，人做判断型工作。让老板从救火队长变成真正的决策者。

**典型场景**：

场景一：竞品监控
- 以前：手动打开生意参谋 → 逐个收集竞品数据 → 发现异常 → 进一步分析排查 → 收集更多数据 → 得出结论 → 决策行动
- 现在：自动采集竞品数据 → LLM 识别异常 → 自动归因 → 主动推送异常给老板 → 老板一键决策

场景二：库存监控
- 以前：库存见底 → 仓库暴露风险 → 运营分析原因 → 紧急补货（7天） → 调整为供应商代发模式 → 补货到仓 → 调回发货模式 → 超卖或发货时效增加
- 现在：自动采集库存数据 → LLM 识别库存风险 → 提前预警 → 人工确认采购 → 货品到仓 → 平滑过渡销量波动

**竞争定位**（三范式框架）：

信息系统 → 知识系统 → 行动系统。现有工具都是局部优化，本产品是垂类电商场景下三段全强、开箱即用。

| 工具 | 信息系统 | 知识系统 | 行动系统 | 核心短板 |
|------|---------|---------|---------|---------|
| 多维表格 | 强 | 弱 | 弱 | 有自动化能力但较弱，缺乏判断和推理 |
| RPA | 弱 | 弱 | 强 | 缺存储层，无知识系统和模型能力，流程全靠人定义 |
| Coze | 弱 | 强 | 中 | 行动依赖API，无法操作无API的系统 |
| CC+RAG | 强 | 强 | 强 | 最强单体，但工程门槛高，难协同 |
| 多维表格+RPA+Coze | 强 | 强 | 强 | 门槛高、价格贵、三套系统集成维护成本极高 |

---

## 2. 产品架构（三层）

```
飞书 Bot（交互层）
  ↕ 通知 / 人工确认 / AI 建议
执行者工作台（执行层）—— Web 应用
  任务管理 | 知识库 | 工具箱
管理工作台（管理层）—— Web 应用
  流程定义 | 工具库 | 组织管理 | 监控 | 分析决策
  ↕
工作流引擎（后端）—— DAG 调度
  自动节点（工具调用）| 人工节点（飞书推送等人响应）
```

**交互层优先级**：飞书（v1），钉钉（后续迭代）

---

## 3. 核心机制：DAG 工作流

### 3.1 流程定义
- 管理者通过自然语言描述流程，AI 生成 DAG
- 支持可视化编辑画布（拖拽节点、连线）
- 流程版本管理，支持回滚
- 节点类型：
  - **自动节点**：API 调用、数据处理、条件分支、定时等待、飞书通知
  - **人工节点**：数值确认、审核判断、内容填写、文件上传、外部操作确认

### 3.2 任务执行
- 触发方式：定时规则、手动触发、飞书 Bot 一键触发
- 自动节点由后端工作流引擎执行
- 人工节点：推送飞书卡片给负责人，等待回复后继续

### 3.3 人机交接节点（核心设计）
人工节点页面（EW-04）展示：
1. 机器已完成的背景信息（摘要）
2. 明确告知人需要做什么
3. AI 建议内容（可修改）
4. 提交后不可撤回的明确提示
5. 操作按钮：全部采纳 AI 建议 / 修改后提交 / 驳回

---

## 4. 页面清单

线框图参考：`prototype/index.html`（导航入口，所有页面均有独立原型文件）

### A. 飞书 Bot 卡片

| ID | 名称 | 说明 |
|----|------|------|
| BOT-01 | 任务推送卡片 | 系统→人，任务启动通知 |
| BOT-02 ★ | 人工确认卡片 | 等待回复的核心交互卡片，支持一键采纳/跳转工作台 |
| BOT-03 | 异常告警卡片 | 超时/失败告警，支持催办/代为处理 |
| BOT-04 | 日报/周报摘要 | 定时推送老板 |
| BOT-05 | AI 决策建议 | 推送老板，一键采纳触发流程 |

深链接规范：
- BOT-02 → `/task/{taskId}/step/{stepId}`
- BOT-03 → `/manage/task/{taskId}`
- BOT-05 → `/manage/suggestions/{id}`

### B. 执行者工作台

| ID | 名称 | 说明 |
|----|------|------|
| EW-01 | 我的看板 | 执行者首页，待办+进行中+快捷入口 |
| EW-02 | 任务列表 | 筛选+搜索，状态分 Tab |
| EW-03 | 任务详情（自动） | DAG 进度图，只读观察 |
| EW-04 ★ | 人工操作步骤 | 人机交接核心页面 |
| EW-05 | 任务历史 | 已完成任务归档，含我的操作记录 |
| EW-06 | 知识库首页 | AI 问答 + 分类浏览 |
| EW-07 | 知识词条详情 | SOP/规范内容，支持反馈 |
| EW-08 | 知识贡献 | 提交新知识/修正，管理员审核后生效 |
| EW-09 | 工具列表 | 有权限的工具，支持手动触发 |
| EW-10 | 工具执行详情 | 日志 + 输出下载 |

### C. 管理工作台

| ID | 名称 | 说明 |
|----|------|------|
| MW-01 | 决策驾驶舱 | 老板首页，全局健康度 + AI 建议 + 进行中任务 |
| MW-02 | 流程定义列表 | 所有 DAG 模板，健康指标 |
| MW-03 ★ | 流程编辑器 | 自然语言→DAG，可视化编辑，节点配置 |
| MW-04 | 流程版本历史 | 版本对比，支持回滚 |
| MW-05 | 工具库管理 | 工具列表，启用/禁用，调用统计 |
| MW-06 | 工具上传/编辑 | 配置工具（API/Webhook/脚本），参数定义，权限设置 |
| MW-07 | 部门管理 | 组织树结构 |
| MW-08 | 角色权限 | 权限矩阵配置，可接收人工节点类型 |
| MW-09 | 成员管理 | 邀请、分配角色部门 |
| MW-10 | 全局任务监控 | 所有进行中任务，甘特图视图，催办 |
| MW-11 | 任务实例详情 | 单任务完整 DAG 执行图，管理员可催办/代为处理/强制终止 |
| MW-12 | 数据分析看板 | 效率趋势，瓶颈识别 |
| MW-13 | AI 决策建议 | 建议列表，采纳/忽略，形成决策记录 |
| MW-14 | 平台集成配置 | 飞书/ERP/电商平台对接 |
| MW-15 | 系统日志 | 操作审计记录 |

---

## 5. 工具层设计

### 5.1 工具类型
| 类型 | 说明 | 执行方式 |
|------|------|---------|
| API 调用 | HTTP 请求外部系统（ERP、电商平台 API） | 后端直接调用 |
| Webhook | 触发外部服务 | 后端发送 HTTP |
| Python 脚本 | 自定义自动化逻辑 | 后端沙箱执行 |

### 5.2 内置工具（开箱即用）
- **生意参谋数据采集**：Playwright headless 采集竞品数据，结果写入 PostgreSQL
- **ERP 库存查询**：通用 HTTP 接口封装
- **发货单导出**：生成 Excel 文件
- **退货快递单批量打印**：对接顺丰/菜鸟 API
- （后续持续扩充）

### 5.3 自定义工具
- 由各部门主管编写 Python 脚本上传
- 平台提供安全沙箱执行环境
- 支持参数定义、权限控制、调用日志

### 5.4 执行环境
- 默认：云端执行（小主机，24/7 在线）
- 浏览器操作类工具（如生意参谋采集）：Playwright headless 运行在小主机
- 账号/Cookie 存储在服务端，不需要客户本地部署任何东西
- 长期规划：支持本地 Agent 模式（客户侧部署）

---

## 6. 知识库设计

### 6.1 内置知识（冷启动内容）
- 电商通用 SOP（退货处理、发货规范、客服话术框架等）
- 平台规则（淘宝/天猫/拼多多 常见规则）
- 按分类组织：仓库操作、客服规范、采购流程、运营规则、产品信息、平台规则

### 6.2 知识管理
- AI 问答（基于知识库 RAG）
- 分类浏览
- 执行者可提交新知识/修正，管理员审核后生效
- 版本管理（v2.3 等）
- 使用统计（查看次数、有帮助人数）

---

## 7. 产品边界

**明确不做的事**：
- 不依赖任何 RPA 软件（影刀等）
- 不要求客户本地部署（v1 阶段）
- 不做钉钉（v1 阶段）
- 不做移动端 App

---

## 8. MVP 范围（v1 阶段交付）

优先实现核心工作流，验证人机协作价值：

**必须有**：
- EW-01 我的看板
- EW-02 任务列表
- EW-03 任务详情（自动步骤）
- EW-04 ★ 人工操作步骤
- MW-01 决策驾驶舱
- MW-03 ★ 流程编辑器（简化版，支持基本 DAG 定义）
- MW-10 全局任务监控
- BOT-02 ★ 人工确认卡片
- BOT-03 异常告警卡片
- 内置工具：生意参谋采集

**可延后**：
- 知识库（EW-06~08）
- 工具箱手动触发（EW-09~10）
- 数据分析看板（MW-12）
- AI 决策建议（MW-13）
- 流程版本历史（MW-04）

---

## 变更记录

| 日期 | 版本 | 说明 |
|------|------|------|
| 2026-02-25 | v0.1 | 初稿，基于产品讨论 session 提炼 |
